{% extends 'base.html' %}
{% block title %}Dashboard - CampusConnect{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <h1 style="font-weight: 800; color: #1f2937; margin-bottom: 0.5rem;">Placement Dashboard</h1>
            <p class="text-muted">Track placement statistics and progress</p>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div style="background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 4px 16px rgba(0,0,0,0.08); text-align: center;">
                <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                    <i class="fas fa-users fa-2x text-white"></i>
                </div>
                <h3 style="font-weight: 800; color: #667eea; font-size: 2.5rem; margin-bottom: 0.5rem;">{{ total_students }}</h3>
                <p style="color: #374151; font-weight: 600; margin-bottom: 0.5rem;">Total Students</p>
                <small style="color: #6b7280;">Registered in system</small>
            </div>
        </div>
        <div class="col-md-3">
            <div style="background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 4px 16px rgba(0,0,0,0.08); text-align: center;">
                <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                    <i class="fas fa-user-check fa-2x text-white"></i>
                </div>
                <h3 style="font-weight: 800; color: #10b981; font-size: 2.5rem; margin-bottom: 0.5rem;">{{ placed_students }}</h3>
                <p style="color: #374151; font-weight: 600; margin-bottom: 0.5rem;">Students Placed</p>
                <small style="color: #6b7280;">{{ placement_percentage }}% placement rate</small>
            </div>
        </div>
        <div class="col-md-3">
            <div style="background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 4px 16px rgba(0,0,0,0.08); text-align: center;">
                <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                    <i class="fas fa-rupee-sign fa-2x text-white"></i>
                </div>
                <h3 style="font-weight: 800; color: #f59e0b; font-size: 2.5rem; margin-bottom: 0.5rem;">₹{{ highest_package }}</h3>
                <p style="color: #374151; font-weight: 600; margin-bottom: 0.5rem;">Highest Package (LPA)</p>
                <small style="color: #6b7280;">Average: ₹{{ avg_package }} LPA</small>
            </div>
        </div>
        <div class="col-md-3">
            <div style="background: white; border-radius: 16px; padding: 2rem; box-shadow: 0 4px 16px rgba(0,0,0,0.08); text-align: center;">
                <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                    <i class="fas fa-building fa-2x text-white"></i>
                </div>
                <h3 style="font-weight: 800; color: #0ea5e9; font-size: 2.5rem; margin-bottom: 0.5rem;">{{ total_companies }}</h3>
                <p style="color: #374151; font-weight: 600; margin-bottom: 0.5rem;">Total Companies</p>
                <small style="color: #6b7280;">Partnership network</small>
            </div>
        </div>
    </div>

    <!-- Charts -->
    <div class="row g-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Placement by Course</h5>
                </div>
                <div class="card-body">
                    <canvas id="courseChart" style="height: 300px;"></canvas>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white;">
                    <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Package Distribution</h5>
                </div>
                <div class="card-body">
                    <canvas id="packageChart" style="height: 300px;"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card">
                <div class="card-header company-header-bg">
                    <h5 class="text-white mb-0">Quick Actions</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'placement:students_list' %}" class="btn btn-outline-primary w-100">
                                <i class="fas fa-users mb-1 d-block"></i>
                                Manage Students
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'placement:companies_list' %}" class="btn btn-outline-success w-100">
                                <i class="fas fa-building mb-1 d-block"></i>
                                View Companies
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="{% url 'placement:job_postings_list' %}" class="btn btn-outline-warning w-100">
                                <i class="fas fa-briefcase mb-1 d-block"></i>
                                Job Postings
                            </a>
                        </div>
                        <div class="col-md-3 mb-3">
                            <a href="/admin/" class="btn btn-outline-info w-100">
                                <i class="fas fa-cog mb-1 d-block"></i>
                                Admin Panel
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Get data from Django template
const coursePlacementData = JSON.parse('{{ course_placement_data|escapejs }}');
const packageDistributionData = JSON.parse('{{ package_distribution|escapejs }}');

// Course Placement Pie Chart
const courseLabels = coursePlacementData.map(item => item.course);
const courseData = coursePlacementData.map(item => item.count);

const courseCtx = document.getElementById('courseChart').getContext('2d');
new Chart(courseCtx, {
    type: 'pie',
    data: {
        labels: courseLabels,
        datasets: [{
            data: courseData,
            backgroundColor: [
                '#667eea',
                '#764ba2', 
                '#f093fb',
                '#f5576c',
                '#10b981',
                '#f59e0b',
                '#ef4444',
                '#0ea5e9'
            ],
            borderWidth: 2,
            borderColor: '#fff'
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                position: 'bottom',
                labels: {
                    padding: 20
                }
            }
        }
    }
});

// Package Distribution Bar Chart
const packageLabels = packageDistributionData.map(item => item.range);
const packageData = packageDistributionData.map(item => item.count);

const packageCtx = document.getElementById('packageChart').getContext('2d');
new Chart(packageCtx, {
    type: 'bar',
    data: {
        labels: packageLabels,
        datasets: [{
            label: 'Number of Students',
            data: packageData,
            backgroundColor: 'rgba(16, 185, 129, 0.8)',
            borderColor: '#10b981',
            borderWidth: 2
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    stepSize: 1
                }
            }
        }
    }
});
</script>
{% endblock %}
